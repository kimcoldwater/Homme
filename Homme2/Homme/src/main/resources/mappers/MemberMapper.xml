<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="MemberMapper">
<!-- 회원가입 -->
<insert id="register">
	insert into MEMBER(MEM_NO, MEM_ID, MEM_PW, MEM_NAME, MEM_POST, MEM_ADR, MEM_TEL, MEM_EMAIL) 
	values(MEMBER_SEQ.NEXTVAL, #{MEM_ID}, #{MEM_PW}, #{MEM_NAME}, #{MEM_POST}, #{MEM_ADR}, #{MEM_TEL}, #{MEM_EMAIL})
</insert>
<!-- 로그인 -->
<select id="login" resultType="kr.co.vo.MemberVO">
	select MEM_PW FROM MEMBER WHERE MEM_ID = #{MEM_ID} <!-- AND MEM_PW = #{MEM_PW} -->
</select>
<!-- 로그인된 경우 해당 세션id와 유효시간을 사용자 테이블에 세팅한다.-->
<update id="keepLogin">
    update MEMBER SET MEM_CKID = #{MEM_CKID}, MEM_CKLIMIT = #{MEM_CKLIMIT} WHERE MEM_ID=#{MEM_ID}
</update>
<!-- 유효기간이 남아 있으면서 해당 sessionId를 가지는 사용자 정보를 꺼내오는 부분-->
<select id="checkUserWithSessionKey" resultType="kr.co.vo.MemberVO">
    select * FROM MEMBER WHERE MEM_CKID = #{MEM_CKID}
</select>
<!-- 회원정보 수정 -->
<update id="memberUpdate">
	update MEMBER SET <!-- MEM_PW = #{MEM_PW}, --> MEM_NAME = #{MEM_NAME}, MEM_POST = #{MEM_POST}, MEM_ADR = #{MEM_ADR}, MEM_TEL = #{MEM_TEL}, MEM_EMAIL = #{MEM_EMAIL} WHERE MEM_ID = #{MEM_ID}
</update>
<!-- 회원삭제 -->
<delete id="memberDelete">
	delete FROM MEMBER WHERE MEM_ID =#{MEM_ID} AND MEM_NAME =#{MEM_NAME} <!-- AND MEM_PW=#{MEM_PW} -->
</delete>
<!-- 패스워드 체크 -->
<select id="passChk" resultType="int">
	select COUNT (*) FROM MEMBER WHERE MEM_ID = #{MEM_ID} AND MEM_PW = #{MEM_PW}
</select>
<!-- 아이디 중복체크 -->
<select id="idChk" resultType="int" >
	select COUNT (*) FROM MEMBER WHERE MEM_ID = #{MEM_ID}
</select>
<!-- 아이디 찾기 -->
<select id="findid" resultType="kr.co.vo.MemberVO">
	select MEM_ID FROM MEMBER WHERE MEM_NAME = #{MEM_NAME} AND MEM_EMAIL = #{MEM_EMAIL}
</select>
<!-- 아이디,이메일 유효성 검사 -->
<select id="findPwCheck" resultType="int">
select count(*) from MEMBER WHERE MEM_EMAIL = #{MEM_EMAIL} AND MEM_ID = #{MEM_ID}
</select>
<!-- 임시비밀번호변경 -->
<update id="findPw" >
update MEMBER SET MEM_PW = #{MEM_PW} WHERE MEM_ID = #{MEM_ID} AND MEM_EMAIL = #{MEM_EMAIL}
</update>
<update id="pwModify">
update MEMBER SET MEM_PW = #{MEM_PW} where identification = #{identification}
</update>
   
</mapper>